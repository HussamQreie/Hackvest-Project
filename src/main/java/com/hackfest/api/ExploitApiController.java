package com.hackfest.api;

import org.springframework.web.bind.annotation.*;
import java.io.*;

@RestController
@RequestMapping("/api/exploit")
public class ExploitApiController {
    @GetMapping("/rce")
    public String rce(@RequestParam String cmd) throws IOException {
        Process p = Runtime.getRuntime().exec(cmd); // RCE vulnerability
        return new String(p.getInputStream().readAllBytes());
    }

    @GetMapping("/fetch")
    public String ssrf(@RequestParam String url) throws IOException {
        return new String(new java.net.URL(url).openStream().readAllBytes()); // SSRF vulnerability, Java 17 compatible
    }
}

// this is updated :)